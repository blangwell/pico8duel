pico-8 cartridge // http://www.pico-8.com
version 35
__lua__
-- ∧ run 
function _init()
	bullet_time = 0
	bullets = {}
	make_player()
end

function _update()
	handle_input()
	if player.shooting == true then
		shootanim(player.dir)
	end
end

function _draw()
	cls()
	map(0,0,0,0,16,16)
	draw_player()
	draw_bullets()
	print(#bullets)

end
-->8
-- 웃 player 
function make_player()
	player = {}
	player.x = 20
	player.y = 20
	player.sprite = 1
	player.flipx = false
	player.speed = 1
	player.shotspeed = 60
	player.dir = "up"
	player.shooting = false
end

function draw_player()
	spr(player.sprite,player.x,player.y,1,1,player.flipx)
end
-->8
-- ⬆️⬇️⬅️➡️ input
function handle_input()
	if player.shooting == false then
		if btn(0) then
			player.x -= player.speed
			player.sprite = 11
			player.flipx = true 
			player.dir = "left"
		elseif btn(1) then
			player.x += player.speed 
			player.sprite = 11
			player.flipx = false 
			player.dir = "right"
		elseif btn(2) then
			player.y -= player.speed 
			player.sprite = 1
			player.dir = "up"
			player.flipx = false
		elseif btn(3) then
			player.y += player.speed 
			player.sprite = 6
			player.dir = "down"
			player.flipx = false
		end
	end	
	
	-- come out the other side	
	if player.x > 128 then player.x = -7 end
	if player.x < -7 then player.x = 127 end
	if player.y > 128 then player.y = -7 end
	if player.y < -7 then player.y = 127 end

 -- shooting
 if (btnp(5) and player.shooting == false) then
 	sfx(0) 	
 	make_bullet()

 	player.shooting = true
 end
end


-->8
-- … gun
function shootanim(playerdir)
	if playerdir == "up" then
		min = 1
		max = 4
	elseif playerdir == "down" then
		min = 6
		max = 10
	elseif playerdir == "left" or playerdir == "right" then
		min = 11
		max = 15
	end
	
	if time() - bullet_time > .1 then
		bullet_time = time()
		player.sprite += 1
	end
	
	if player.sprite > max then
		player.sprite = min
		player.shooting = false
		deli(bullets)
	end
end



function make_bullet()
	bullet = {}
	bullet.offsetx = 0
	bullet.offsety = 0
	if player.dir == "up" then
		bullet.offsetx = 6
		bullet.offsety = -2
		bullet.x = player.x 
		bullet.y = -4
	elseif player.dir == "down" then
		bullet.offsetx = 1
		bullet.offsety = 8
		bullet.x = player.x
		bullet.y = 128
	elseif player.dir == "left" then
		bullet.offsetx = -2
		bullet.offsety = 4
		bullet.x = -4
		bullet.y = player.y
	elseif player.dir == "right" then
		bullet.offsetx = 9
		bullet.offsety = 4
		bullet.x = 128
		bullet.y = player.y
	end
	add(bullets, bullet)
end



function draw_bullets()
	for b in all(bullets) do				
		line(player.x+b.offsetx,player.y+b.offsety,b.x+b.offsetx,b.y+b.offsety)
	end
end


__gfx__
00000000404444044044440440444404404444044044440440444404404444044044440440444404404444040444440004444400044444000444440004444400
00000000444444444444444444444444444444444444444444444444444444444444444444444444444444444444444044444440444444404444444044444440
00700700009999000099990000999900009999000099990000cffc0000cffc0000cffc0000cffc0000cffc000099f0000099f0000099f0000099f0000099f000
000770000099990000999900009999a0009999000099990000ffff0000ffff0000ffff0000ffff0000ffff00009ff000009ff000009ff00a009ff000009ff000
0007700077444477774444707744448a774444707744447777477477004774770a47747700477477774774770047400000447550004475a80044755000474000
00700700f044440ff0444470f04444a0f0444470f044440ff047740f0547740fa8a7740f0547740ff047740f004f400000447f0000447f0a00447f00004f4000
000000000044445000444400004444000044440000444450054774000f4774000a4774000f477400054774000045400000444000004440000044400000454000
00000000001001500010010000100100001001000010015005100100001001000010010000100100051001000015100000111000001110000011100000151000
00555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56666665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeee22deeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
e777eeeeede22e2ee2eeeeeeeeee222eeeeddeeeeee2eeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
e070eeeee2e2222e2eeeeeeeeee2222eedddddeeee22eeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
e777ee7ee2222eeeeeeeeeeeeeee222eedddd2d2eeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
eeeeee77eee22deeeeeeeeeeeeee22eeedeeeddde2eeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
eeeee7eeeeed2eeeeeee2eeeeeeeeeeeeddeee8eeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
eee77eeeeee22eeeeeeeee2eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
eeee7eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000004044440440444404404444044044440404444400044444004045050400000000
00000000000000000000000000000000000000000000000000000000000000004444444444444444444444444444444444444440444444404445554400000000
0000000000000000000000000000000000000000000000000000000000000000009999000099990000cffc0000cffc000099f0000099f000f0cffc0f00000000
000000000000000000000000000000000000000000000000000000000000000000999900009999a000ffff0000ffff00009ff000009ff00a70ff5f0700000000
0000000000000000000000000000000000000000000000000000000000000000774444777744448a774774770a47747700447550004475a80747747000000000
0000000000000000000000000000000000000000000000000000000000000000f044440ff04444a0f047740fa8a7740f00447f0000447f0a0047740000000000
00000000000000000000000000000000000000000000000000000000000000000044445000444400054774000a47740000444000004440000047740000000000
00000000000000000000000000000000000000000000000000000000000000000010015000100100051001000010010000111000001110000010010000000000
__map__
2626262626262626262626262626262622000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2622262626262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2621262626262526262623212626222626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262426262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262426262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626262026000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262226262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2625262626262326262622262626212626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626222626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626212226262626262626232626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262426262626262621262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626202626262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626262026000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262126262326262626262624262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2626262626262626262626262626262626000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
c10400000000000000000000000034650346503a65022650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
